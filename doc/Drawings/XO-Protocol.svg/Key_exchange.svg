<?xml version="1.0"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 559 783" width="559pt" height="783pt"><metadata xmlns:dc="http://purl.org/dc/elements/1.1/"><dc:date>2014-04-10 12:12Z</dc:date><!-- Produced by OmniGraffle Professional 5.4.4 --></metadata><defs><filter id="Shadow" filterUnits="userSpaceOnUse"><feGaussianBlur in="SourceAlpha" result="blur" stdDeviation="3.488"/><feOffset in="blur" result="offset" dx="0" dy="4"/><feFlood flood-color="black" flood-opacity=".75" result="flood"/><feComposite in="flood" in2="offset" operator="in"/></filter><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="532.22656" cap-height="719.72656" ascent="770.01953" descent="-229.98047" font-weight="bold"><font-face-src><font-face-name name="Helvetica-Bold"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="StickArrow_Marker" viewBox="-1 -6 14 12" markerWidth="14" markerHeight="12" color="black"><g><path d="M 11.428568 0 L 0 0 M 0 -4.285713 L 11.428568 0 L 0 4.285713" fill="none" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica" font-size="10" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="HalfStickArrow_Marker" viewBox="-1 -1 14 7" markerWidth="14" markerHeight="7" color="black"><g><path d="M 11.428568 0 L 0 0 M 0 4.285713 L 11.428568 0" fill="none" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Key exchange</title><rect fill="white" width="559" height="783"/><g><title>Layer 1</title><g><use xl:href="#id4_Graphic" filter="url(#Shadow)"/><use xl:href="#id40_Graphic" filter="url(#Shadow)"/><use xl:href="#id47_Graphic" filter="url(#Shadow)"/><use xl:href="#id48_Graphic" filter="url(#Shadow)"/><use xl:href="#id26_Graphic" filter="url(#Shadow)"/><use xl:href="#id58_Graphic" filter="url(#Shadow)"/><use xl:href="#id71_Graphic" filter="url(#Shadow)"/><use xl:href="#id72_Graphic" filter="url(#Shadow)"/></g><rect x="58" y="59.999954" width="108" height="41.628937" fill="white"/><rect x="58" y="59.999954" width="108" height="41.628937" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(63 73.814422)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="28.65918" y="11" textLength="40.68164">Sender</tspan></text><line x1="112" y1="102.12889" x2="112" y2="595.22913" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="233.33331" y="59.999985" width="108" height="41.628937" fill="white"/><rect x="233.33331" y="59.999985" width="108" height="41.628937" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(238.33331 73.814454)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="30.317383" y="11" textLength="37.365234">Server</tspan></text><line x1="287.33331" y1="102.12892" x2="287.33331" y2="595.22925" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="417.33334" y="59.999985" width="108" height="41.628937" fill="white"/><rect x="417.33334" y="59.999985" width="108" height="41.628937" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(422.33334 73.814454)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="23.980469" y="11" textLength="50.039062">Receiver</tspan></text><line x1="471.33334" y1="102.12892" x2="471.33334" y2="595.22937" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id4_Graphic"><rect x="103.5" y="180.5177" width="17" height="136.92255" fill="white"/><rect x="103.5" y="180.5177" width="17" height="136.92255" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><line x1="120.5" y1="263.05209" x2="269.75486" y2="263.67555" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(146.55212 246.49609)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="116.171875">updatePresence(…,keyId)</tspan></text><g id="id40_Graphic"><rect x="278.83331" y="263.73123" width="17" height="47.424454" fill="white"/><rect x="278.83331" y="263.73123" width="17" height="47.424454" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><line x1="278.83331" y1="300.23697" x2="134.49514" y2="300.48014" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="1,4"/><text transform="translate(163.77441 283.45682)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="76.69922">return(presence) </tspan></text><g id="id47_Graphic"><rect x="278.83331" y="352.0445" width="17" height="47.424454" fill="white"/><rect x="278.83331" y="352.0445" width="17" height="47.424454" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><line x1="296.33327" y1="299.2932" x2="453.75586" y2="297.29007" marker-end="url(#HalfStickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(301.37151 277.57543)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="173.97461">presenceUpdated(…,client,[keyId,Key])</tspan></text><g id="id48_Graphic"><rect x="462.83334" y="297.12048" width="17" height="90.924103" fill="white"/><rect x="462.83334" y="297.12048" width="17" height="90.924103" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><g id="id26_Graphic"><path d="M 279.5 299.73123 L 284.48177 299.73123 C 286.97265 299.73123 289.46353 295.23123 289.46353 281.73123 C 289.46353 268.23123 286.97265 263.73123 284.48177 263.73123 L 279.5 263.73123 Z" fill="white"/><path d="M 279.5 299.73123 L 284.48177 299.73123 C 286.97265 299.73123 289.46353 295.23123 289.46353 281.73123 C 289.46353 268.23123 286.97265 263.73123 284.48177 263.73123 L 279.5 263.73123 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><line x1="462.83334" y1="350.3015" x2="304.91118" y2="351.90884" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(334.02805 334.23973)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="90.595703">getKey(client, keyId)</tspan></text><g id="id58_Graphic"><path d="M 295.83331 352.0445 L 290.85155 352.0445 C 288.36066 352.0445 285.86978 356.5445 285.86978 370.0445 C 285.86978 383.5445 288.36066 388.0445 290.85155 388.0445 L 295.83331 388.0445 Z" fill="white"/><path d="M 295.83331 352.0445 L 290.85155 352.0445 C 288.36066 352.0445 285.86978 356.5445 285.86978 370.0445 C 285.86978 383.5445 288.36066 388.0445 290.85155 388.0445 L 295.83331 388.0445 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><line x1="295.83331" y1="387.61283" x2="449.5049" y2="386.93574" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="1,4"/><text transform="translate(349.5875 370.32139)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="65.024414">return(keyInfo)</tspan></text><text transform="translate(58.333252 26)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".26464844" y="11" textLength="247.4707">Key Exchange (how it should be implemented)</tspan></text><line x1="121.16669" y1="180.53821" x2="265.00475" y2="180.51999" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(154.856415 163.61877)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="66.708984">updateKey(key</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="65.97168" y="10" textLength="30.009766">,keyId)</tspan></text><g id="id71_Graphic"><rect x="278.83331" y="180.5177" width="17" height="47.424454" fill="white"/><rect x="278.83331" y="180.5177" width="17" height="47.424454" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><g id="id72_Graphic"><path d="M 279.5 216.5177 L 284.48177 216.5177 C 286.97265 216.5177 289.46353 212.0177 289.46353 198.5177 C 289.46353 185.0177 286.97265 180.5177 284.48177 180.5177 L 279.5 180.5177 Z" fill="white"/><path d="M 279.5 216.5177 L 284.48177 216.5177 C 286.97265 216.5177 289.46353 212.0177 289.46353 198.5177 C 289.46353 185.0177 286.97265 180.5177 284.48177 180.5177 L 279.5 180.5177 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><line x1="279.5" y1="215.00006" x2="134.49514" y2="215.26216" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="1,4"/><text transform="translate(178.1161 198.22992)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="0" y="10" textLength="48.34961">return(null)</tspan></text></g></g></svg>
